See this [more recent, improved version](/mbostock/3887051).